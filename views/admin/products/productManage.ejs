<%- include('../layouts/adminHeader') -%>

<section class="container-fluid p-0 d-flex">
<aside class="side-bar mt-4 " id="aside-menu">
    <button class="side-menu border-0 m-1" id="menu-btn"  onclick="asideShow()"><span class="material-symbols-outlined">menu</span></button>   
    <div class="menu-items m-1 pt-2" id="menu-page">      
        <a href="/admin/dashboard" class="text-black text-decoration-none"><button id="admn-btns" class="admn-btn mb-2 w-100 text-start "><i class="bi bi-box2-fill ms-3"></i> Dashboard</button></a>
        <a href="/admin/users" class="text-black text-decoration-none"><button class="admn-btn mb-2 w-100 text-start "><i class="bi bi-people-fill ms-3"></i> Customers</button></a>
        <a href="/admin/productManage" class="text-black text-decoration-none"><button class="admn-btn-A mb-2 w-100 text-start "><i class="bi bi-archive-fill ms-3"></i> Products</button></a>
        <a href="" class="text-black text-decoration-none"><button class="admn-btn mb-2 w-100 text-start "><i class="bi bi-file-earmark-fill ms-3"></i> Orders</button></a>
        <a href="/admin/categoryManage" class="text-black text-decoration-none"><button class="admn-btn mb-2 w-100 text-start "><i class="bi bi-diagram-2-fill ms-3"></i> Category</button></a>
        <a href="" class="text-black text-decoration-none"><button class="admn-btn mb-2 w-100 text-start "><i class="bi bi-card-image ms-3"></i> Banners</button></a>
        <a href="" class="text-black text-decoration-none"><button class="admn-btn mb-2 w-100 text-start "><i class="bi bi-star-fill ms-3"></i> coupons</button></a>
        <a href="" class="text-black text-decoration-none"><button class="admn-btn mb-2 w-100 text-start "><i class="bi bi-clipboard-data-fill ms-3"></i> Sales Report</button></a>
    </div>
    <div class="adm-lgout m-1" id="l-out-btn">
        <a class="text-black text-decoration-none" href="/admin/adminLogout"><button class="admn-btn w-100 text-start "><i class="bi bi-box-arrow-right ms-3"></i> Logout</button></a>
    </div>
</aside>
<div class="mt-4 p-2 w-75">
    <a href="/admin/addProduct"><button type="button" class="btn text-black fw-bold" style="background-color: #58d645;"><i class="fa-solid fa-plus"></i> Add Products</button></a>
    <div class="d-flex align-items-center ps-3  mt-2">
        <div class="table-responsive">
        <table class="table table-bordered table-success">
            <tr>
                <th colspan="7"></th>
            </tr>
            <tr>
                <th>Name</th>
                <th>Brnad</th>
                <th>Category</th>
                <th>Price</th>
                <th>Quantity</th>                
                <th>Image</th>
                <th>Actions</th>
            </tr>
            <% if(product.length > 0){ %>
                <% product.forEach((item)=>{ %>                   
                       <tr>
                        <td>
                            <%= item.name %>
                        </td>
                        <td>
                            <%= item.brand %>
                        </td>
                        <td>
                            <%= item.category %>
                        </td>
                        <td>
                            â‚¹<%= item.price %>
                        </td>
                        <td>
                            <%= item.quantity %>
                        </td>
                        <td>
                            <% item.images.forEach((img)=>{ %> 
                                <img src="<%= img.path.replace('public', '') %>" style="width: 14%;">
                            <% }) %> 
                            
                        </td>
                        <td>
                            <div class="d-flex">
                            <a href="/admin/editProduct?id=<%= item._id %>"><button type="submit" class="btn btn-primary me-1"><i class="fa-solid fa-pen"></i></button></a>
                            <% if(item.is_there === true){ %>
                                <form action="/admin/removeProduct" method="post">
                                    <input type="hidden" name="id" value="<%= item._id %>">   
                                    <button type="submit" class="btn" style="background-color: #ff3030;"><i class="fa-solid fa-trash-can"></i></button>                                                                       
                                </form>
                            <% }else{ %>  
                                <form action="/admin/recoverProduct" method="post">
                                    <input type="hidden" name="id" value="<%= item._id %>">                                       
                                    <button type="submit" class="btn" style="background-color: #ffff00;"><i class="fa-solid fa-arrow-rotate-left"></i></button>
                                </form>
                            <% } %>
                            </div>
                        </td>
                    </tr>
                    <% }) %>                         
                        <% }else{ %>
                            <tr>
                                <td colspan="7">Product not found</td>
                            </tr>
                            <% } %>
        </table>
    </div>
    </div>
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-end">
          <li class="page-item">
            <a class="page-link" href="<%= currentPage > 1 ? `?page=${currentPage - 1}&search=${search}` : '#' %>" aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
            </a>
          </li>
          <% for (let i = 1; i <= totalPages; i++) { %>
            <li class="page-item <%= i === currentPage ? 'active' : '' %>">
              <a class="page-link" href="<%= `?page=${i}` %>"><%= i %></a>
            </li>
          <% } %>
          <li class="page-item">
            <a class="page-link" href="<%= currentPage < totalPages ? `?page=${currentPage + 1}&search=${search}` : '#' %>" aria-label="Next">
              <span aria-hidden="true">&raquo;</span>
            </a>
          </li>
        </ul>
      </nav>
</div>
</section>


<%- include('../layouts/footer') -%>